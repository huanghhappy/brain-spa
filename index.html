<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>è§£å£“æ²»ç™‚æ‰€ Brain SPA</title>
    <style>
        @font-face { font-family: 'GenSenRounded2TW'; src: url('500.otf') format('opentype'); font-weight: 500; }
        @font-face { font-family: 'GenSenRounded2TW'; src: url('700.otf') format('opentype'); font-weight: 700; }
        @font-face { font-family: 'GenSenRounded2TW'; src: url('900.otf') format('opentype'); font-weight: 900; }

        :root {
            --bg-color: #FDF6E3; --primary: #FFB3BA; --secondary: #BAE1FF;
            --text-color: #555555; --card-bg: #FFFFFF;
        }

        * {
            box-sizing: border-box; font-family: 'GenSenRounded2TW', 'Noto Sans TC', sans-serif;
            margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color); color: var(--text-color);
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; min-height: 100dvh; 
            padding: 2.5vh 15px 1.5vh 15px; justify-content: space-between; overflow: hidden;
        }

        #main-screen-container {
            flex: 1; display: flex; flex-direction: column; align-items: center;
            justify-content: flex-start; padding-top: 1vh; width: 100%; max-width: 500px;
        }

        #main-screen { width: 100%; display: flex; flex-direction: column; align-items: center; }

        h1 { font-size: 24px; font-weight: 900; margin-bottom: 2.5vh; color: #333; text-align: center; }

        .severity-selector {
            background: var(--card-bg); padding: 15px; border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 3vh; text-align: center; width: 100%;
        }

        .severity-selector p { font-size: 14px; font-weight: 700; margin-bottom: 12px; }

        input[type=range] {
            -webkit-appearance: none; width: 100%; height: 12px; border-radius: 6px;
            background: #eee; outline: none; margin: 10px 0;
        }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 36px; height: 36px;
            cursor: pointer; background: var(--thumb-img) center/contain no-repeat;
            background-color: transparent; border: none; transform: translateY(-2px);
        }

        .game-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; width: 100%;
        }

        .game-btn {
            background-color: var(--card-bg); border: none; border-radius: 12px;
            padding: clamp(12px, 2vh, 18px) 5px; font-size: 14px; font-weight: 700;
            color: var(--text-color); cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: transform 0.1s; display: flex; flex-direction: row;
            align-items: center; justify-content: center; gap: 6px; white-space: nowrap;
        }
        .game-btn:active { transform: scale(0.95); }
        .game-btn .icon { font-size: 18px; }

        footer { margin-top: auto; font-size: 11px; font-weight: 500; color: #aaaaaa; text-align: center; }

        #game-screen {
            display: none; flex: 1; flex-direction: column; align-items: center;
            width: 100%; max-width: 500px; justify-content: center; position: relative;
        }

        .back-btn {
            position: absolute; top: 0; left: 0; background: var(--primary); color: white;
            border: none; padding: 8px 15px; border-radius: 20px; font-size: 14px;
            font-weight: 700; cursor: pointer; box-shadow: 0 4px 10px rgba(255, 179, 186, 0.4); z-index: 10;
        }

        .game-container {
            width: 100%; flex: 1; max-height: 70vh; display: flex; justify-content: center;
            align-items: center; background: var(--card-bg); border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow: hidden; position: relative;
            margin-top: 45px; margin-bottom: 20px; flex-direction: column;
        }

        /* --- å°éŠæˆ²å°ˆå±¬ CSS --- */
        /* æ­ªåœ– */
        #frame-img { width: 150px; transition: transform 0.1s; cursor: grab; }
        #frame-img.perfect { transform: rotate(0deg) !important; transition: transform 0.3s; pointer-events: none; }
        
        /* æ³¡æ³¡ç´™ */
        .bubble-wrap { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; padding: 10px; }
        .bubble { width: 45px; height: 45px; background: radial-gradient(circle at 30% 30%, #ffffff, #BAE1FF); border-radius: 50%; box-shadow: inset 0 -2px 5px rgba(0,0,0,0.1), 0 2px 5px rgba(0,0,0,0.2); cursor: pointer; }
        .bubble.popped { background: #e0f0ff; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); transform: scale(0.9); }

        /* é‰›ç­† */
        .pencil-stage { display: flex; align-items: flex-end; gap: 15px; height: 200px; border-bottom: 5px solid #eee; padding-bottom: 10px; }
        .pencil { width: 40px; background: #FFDFBA; border-radius: 5px 5px 0 0; position: relative; cursor: pointer; transition: height 0.1s; display: flex; justify-content: center; box-shadow: inset -5px 0 10px rgba(0,0,0,0.1); }
        .pencil::after { content: ''; position: absolute; top: 0; width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 30px solid #FFDFBA; transform: translateY(-100%); }
        .pencil::before { content: 'ğŸ–ï¸'; position: absolute; top: -35px; font-size: 20px; pointer-events: none; z-index: 2; }

        /* é¡è‰²æ’åº */
        .color-stage { display: flex; flex-direction: column; gap: 10px; width: 80%; }
        .color-block { height: 50px; border-radius: 15px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .color-block.selected { transform: scale(0.95); box-shadow: inset 0 4px 6px rgba(0,0,0,0.2); border: 3px solid #fff; }

        /* æ“ ç—˜ç—˜ */
        .pimple-skin { width: 200px; height: 200px; background: #FFE4C4; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: inset -10px -10px 30px rgba(0,0,0,0.1); position: relative; cursor: pointer; }
        .pimple { width: 60px; height: 60px; background: radial-gradient(circle at 30% 30%, #FF8C8C, #FF4040); border-radius: 50%; box-shadow: 0 5px 15px rgba(255,64,64,0.4); transition: all 0.2s; display: flex; justify-content: center; align-items: center; }
        .pimple-core { width: 15px; height: 15px; background: #FFFACD; border-radius: 50%; opacity: 0.8; }
        .popped-effect { display: none; font-size: 50px; position: absolute; }

    </style>
</head>
<body>

    <div id="main-screen-container">
        <div id="main-screen">
            <h1>ğŸ§  è§£å£“æ²»ç™‚æ‰€ Brain SPA âœ¨</h1>
            <div class="severity-selector">
                <p>è«‹é¸æ“‡ä½ ç›®å‰çš„å¼·è¿«ç—‡ç™¼ä½œæŒ‡æ•¸</p>
                <input type="range" id="severity-slider" min="0" max="10" value="5">
                <div style="display: flex; justify-content: space-between; font-size: 11px; font-weight: 500; color: #aaa; margin-top: 5px;">
                    <span>å¾®ç„¦æ…®</span><span>å¿«çˆ†ç‚¸</span>
                </div>
            </div>

            <div class="game-grid">
                <button class="game-btn" onclick="startGame('align')"><span class="icon">ğŸ–¼ï¸</span> æ­ªåœ–æ‰¶æ­£</button>
                <button class="game-btn" onclick="startGame('bubble')"><span class="icon">ğŸ«§</span> æ“ æ³¡æ³¡ç´™</button>
                <button class="game-btn" onclick="startGame('pencil')"><span class="icon">ğŸ–ï¸</span> é‰›ç­†å‰Šå¹³</button>
                <button class="game-btn" onclick="startGame('color')"><span class="icon">ğŸŒˆ</span> é¡è‰²æ’åº</button>
                <button class="game-btn" onclick="startGame('pimple')"><span class="icon">ğŸ’¥</span> æ“ ç—˜ç—˜</button>
                <button class="game-btn" onclick="alert('æº–å‚™è§£é–ä¸­ï¼å…ˆç©ç©å‰é¢äº”å€‹å§ğŸ˜‰')"><span class="icon">ğŸ“¦</span> è²“å’ªæ­¸ä½</button>
                <button class="game-btn" onclick="alert('æº–å‚™è§£é–ä¸­ï¼å…ˆç©ç©å‰é¢äº”å€‹å§ğŸ˜‰')"><span class="icon">ğŸ©¹</span> æ’•é™¤æ¨™ç±¤</button>
                <button class="game-btn" onclick="alert('æº–å‚™è§£é–ä¸­ï¼å…ˆç©ç©å‰é¢äº”å€‹å§ğŸ˜‰')"><span class="icon">ğŸ§¹</span> æ¡Œå¸ƒé™¤å¡µ</button>
                <button class="game-btn" onclick="alert('æº–å‚™è§£é–ä¸­ï¼å…ˆç©ç©å‰é¢äº”å€‹å§ğŸ˜‰')"><span class="icon">ğŸª†</span> ä¿„ç¾…æ–¯å¥—å¨ƒ</button>
                <button class="game-btn" onclick="alert('æº–å‚™è§£é–ä¸­ï¼å…ˆç©ç©å‰é¢äº”å€‹å§ğŸ˜‰')"><span class="icon">ğŸ“„</span> ç¢ç´™æ©Ÿ</button>
            </div>
        </div>
    </div>

    <div id="game-screen">
        <button class="back-btn" onclick="showMainScreen()">ğŸ”™ è¿”å›</button>
        <div class="game-container" id="game-content"></div>
    </div>

    <footer>Â© 2026 an App a Day Project.</footer>

    <script>
        const mainScreenContainer = document.getElementById('main-screen-container');
        const gameScreen = document.getElementById('game-screen');
        const gameContent = document.getElementById('game-content');
        const footer = document.querySelector('footer');
        
        const emojis = ['ğŸ«£', 'ğŸ˜–', 'ğŸ«¨', 'ğŸ˜µâ€ğŸ’«', 'ğŸ« ', 'ğŸ¥¶', 'ğŸ¤¢', 'ğŸ¤®', 'ğŸ˜µ', 'ğŸ¤¯', 'ğŸ’¥'];
        const slider = document.getElementById('severity-slider');

        function updateSliderEmoji() {
            const currentEmoji = emojis[parseInt(slider.value)];
            const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><text x="50%" y="50%" dominant-baseline="central" text-anchor="middle" font-size="30">${currentEmoji}</text></svg>`;
            slider.style.setProperty('--thumb-img', `url('data:image/svg+xml;utf8,${encodeURIComponent(svg)}')`);
        }
        slider.addEventListener('input', updateSliderEmoji);
        updateSliderEmoji();

        function startGame(gameId) {
            mainScreenContainer.style.display = 'none';
            gameScreen.style.display = 'flex'; footer.style.display = 'none';
            gameContent.innerHTML = ''; 
            
            // è·¯ç”±åˆ‡æ›éŠæˆ²
            if (gameId === 'align') initAlignGame();
            if (gameId === 'bubble') initBubbleGame();
            if (gameId === 'pencil') initPencilGame();
            if (gameId === 'color') initColorGame();
            if (gameId === 'pimple') initPimpleGame();
        }

        function showMainScreen() {
            gameScreen.style.display = 'none';
            mainScreenContainer.style.display = 'flex'; footer.style.display = 'block';
        }

        // --- 1. æ­ªåœ–æ‰¶æ­£ ---
        function initAlignGame() {
            let angle = (Math.random() * 30 + 15) * (Math.random() > 0.5 ? 1 : -1);
            gameContent.innerHTML = `<p style="margin-bottom:20px;font-weight:700;">æ‹–æ›³åœ–ç‰‡æŠŠå®ƒè½‰æ­£å§ï¼</p>
                <div id="frame-img" style="height:120px; background:#FFD1DC; border:10px solid #FFF; box-shadow:0 4px 10px rgba(0,0,0,0.1); transform:rotate(${angle}deg); display:flex; justify-content:center; align-items:center; font-size:40px; border-radius:10px;">ğŸŒ¸</div>`;
            const img = document.getElementById('frame-img');
            let isDragging = false, startX;
            img.addEventListener('pointerdown', e => { isDragging = true; startX = e.clientX; });
            window.addEventListener('pointermove', e => {
                if (!isDragging) return;
                angle += (e.clientX - startX) * 0.2; startX = e.clientX;
                img.style.transform = `rotate(${angle}deg)`;
                if (Math.abs(angle) < 3) { isDragging = false; img.classList.add('perfect'); setTimeout(() => alert('âœ¨ å®Œç¾å°é½Šï¼å¥½èˆ’æš¢ï¼'), 300); }
            });
            window.addEventListener('pointerup', () => isDragging = false);
        }

        // --- 2. æ“ æ³¡æ³¡ç´™ ---
        function initBubbleGame() {
            let html = `<div class="bubble-wrap">`;
            for(let i=0; i<20; i++) html += `<div class="bubble" onclick="this.classList.add('popped')"></div>`;
            html += `</div>`;
            gameContent.innerHTML = `<p style="margin-bottom:20px;font-weight:700;">ç›¡æƒ…æçˆ†å®ƒå€‘å§ï¼</p>${html}<button onclick="startGame('bubble')" style="margin-top:20px;padding:10px 20px;border-radius:15px;border:none;background:var(--primary);color:white;font-weight:700;cursor:pointer;">ğŸ”„ æ›ä¸€å¼µ</button>`;
        }

        // --- 3. é‰›ç­†å‰Šå¹³ ---
        function initPencilGame() {
            let h1 = 150, h2 = 180, h3 = 130; // åˆå§‹é«˜åº¦
            gameContent.innerHTML = `<p style="margin-bottom:20px;font-weight:700;">é»æ“Šéé•·çš„é‰›ç­†ï¼ŒæŠŠå®ƒå€‘å‰Šå¹³é½Šï¼</p>
                <div class="pencil-stage">
                    <div class="pencil" id="p1" style="height:${h1}px;" onclick="shave('p1')"></div>
                    <div class="pencil" id="p2" style="height:${h2}px;" onclick="shave('p2')"></div>
                    <div class="pencil" id="p3" style="height:${h3}px;" onclick="shave('p3')"></div>
                </div>`;
            window.shave = function(id) {
                const el = document.getElementById(id);
                let h = parseInt(el.style.height);
                if(h > 100) { el.style.height = (h - 10) + 'px'; }
                checkPencils();
            }
            function checkPencils() {
                const p1 = parseInt(document.getElementById('p1').style.height);
                const p2 = parseInt(document.getElementById('p2').style.height);
                const p3 = parseInt(document.getElementById('p3').style.height);
                if(p1 === 100 && p2 === 100 && p3 === 100) { setTimeout(() => alert('âœ¨ å…¨éƒ¨ä¸€æ¨£å¹³äº†ï¼å¤ªèˆ’æœäº†ï¼'), 300); }
            }
        }

        // --- 4. é¡è‰²æ’åº ---
        function initColorGame() {
            const correctOrder = ['#FFB3BA', '#FFC8C8', '#FFDED6', '#FFEBE4', '#FFF6E3'];
            let currentOrder = [...correctOrder].sort(() => Math.random() - 0.5); // æ‰“äº‚
            
            const renderBlocks = () => {
                let html = `<p style="margin-bottom:20px;font-weight:700;">é»æ“Šå…©å¡Šé¡è‰²ä¾†äº¤æ›ï¼Œæ’æˆæ¼¸å±¤ï¼</p><div class="color-stage">`;
                currentOrder.forEach((color, idx) => {
                    html += `<div class="color-block" style="background:${color}" onclick="selectColor(${idx})" id="cb-${idx}"></div>`;
                });
                gameContent.innerHTML = html + `</div>`;
            };
            
            let selectedIdx = -1;
            window.selectColor = function(idx) {
                const block = document.getElementById(`cb-${idx}`);
                if(selectedIdx === -1) {
                    selectedIdx = idx; block.classList.add('selected');
                } else {
                    // äº¤æ›
                    let temp = currentOrder[selectedIdx];
                    currentOrder[selectedIdx] = currentOrder[idx];
                    currentOrder[idx] = temp;
                    selectedIdx = -1;
                    renderBlocks();
                    // æª¢æŸ¥æ˜¯å¦å®Œæˆ
                    if(JSON.stringify(currentOrder) === JSON.stringify(correctOrder)) {
                        setTimeout(() => alert('âœ¨ æ¼¸å±¤å¥½å®Œç¾ï¼çœ¼ç›ç™‚ç™’äº†ï¼'), 300);
                    }
                }
            }
            renderBlocks();
        }

        // --- 5. æ“ ç—˜ç—˜ ---
        function initPimpleGame() {
            let pressCount = 0;
            gameContent.innerHTML = `<p style="margin-bottom:20px;font-weight:700;">é€£é»ç—˜ç—˜æŠŠå®ƒæ“ çˆ†ï¼</p>
                <div class="pimple-skin" onclick="popIt()">
                    <div class="pimple" id="the-pimple"><div class="pimple-core"></div></div>
                    <div class="popped-effect" id="pop-fx">ğŸ’¥</div>
                </div>
                <button onclick="startGame('pimple')" style="margin-top:20px;padding:10px 20px;border-radius:15px;border:none;background:var(--primary);color:white;font-weight:700;cursor:pointer;">ğŸ”„ å†æ“ ä¸€é¡†</button>`;
            
            window.popIt = function() {
                if(pressCount >= 3) return;
                pressCount++;
                const pimple = document.getElementById('the-pimple');
                pimple.style.transform = `scale(${1 + pressCount * 0.2})`; // è¶Šé»è¶Šå¤§
                if(pressCount === 3) {
                    pimple.style.display = 'none';
                    const fx = document.getElementById('pop-fx');
                    fx.style.display = 'block';
                    setTimeout(() => alert('âœ¨ å™—æ»‹ï¼ä¹¾æ·¨æºœæºœï¼'), 200);
                }
            }
        }
    </script>
</body>
</html>
